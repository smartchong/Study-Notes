# CDN(Content Delivery Network) 内容分发网络

## 概念  
   基于地理位置的分布式代理服务器/数据中心

## 核心作用  
   帮助用户加速获取互联网资源。CDN通过在不同地域建数据中心、购买服务器让用户可就近访问互联网资源。CDN有效分散流量，降低延迟并提升传输速度。 

## 优点
   * 提供高可用（某节点挂掉后，可从其他节点获取数据）
   * 提升性能（用户从距离自身更近的节点获取数据）
   * 提升体验（获取数据的时间更短）

## 工作原理  
   1. 当用户输入网址，浏览器会检查所有资源的请求
   2. 首先进行一次DNS查询，CDN服务返回一条CNAME记录（CDN提供商别名）
   3. 然后浏览器根据返回的CNAME记录查询到CDN智能服务ip
   4. 访问CDN智能调度中心（智能DNS），若发现存在用户需要访问的资源则调度中心返回距离用户最近的节点的资源ip；若发现无用户需要访问的资源则通过__CDN回源__访问源内容服务获取资源  

## 智能DNS  
   CDN核心为一智能DNS服务，当有DNS query到达该智能DNS服务，会根据query所在地域就近分配不同服务器IP

## 对接CDN的方式
   * 将资源所在域名的ns记录直接指向CDN的智能DNS  
   * 通过CNAME记录直接CNAME到CDN域名， 然后CDN域名再ns到CDN智能DNS服务

## 回源问题  
   CDN资源节点发现请求的资源本地无缓存，尝试请求资源原始提供方。      

## 实践
   * 思考：之前有一张图片通过CDN发布，现在想换一张，如何做？  
   用新图片替换旧图片，修改关联的html和css  

   * CDN云测工具  
   1. [站长之家CDN云观测](https://cdn.chinaz.com/)
   2. [17CE](https://www.17ce.com/)

